["ProtectedRoute`](src/components/ProtectedRoute.tsx:1) component\n- **User Profile**: Name, email, bio, and avatar support\n\n### 3.2 Financial Tracking\n- **Income/Expense Management**: Full CRUD operations for financial transactions\n- **Categories**: Categorization of transactions\n- **Date Tracking**: Transaction dates with sorting capabilities\n- **API Endpoints**: [`/api/finances`](src/api/finances/route.ts:1) (GET, POST, PUT, DELETE)\n\n### 3.3 Budget Management\n- **Monthly Budgets**: Set spending limits per category per month\n- **Budget Tracking**: Real-time calculation of spent vs. remaining amounts\n- **Alert Thresholds**: Configurable warning thresholds (default: 80%)\n- **Budget Status**: Visual indicators (ok, warning, exceeded)\n- **API Endpoints**: [`/api/budgets`](src/app/api/budgets/route.ts:1) (GET, POST, PUT, DELETE)\n\n### 3.4 Saving Goals\n- **Goal Creation**: Set target amounts with optional deadlines\n- **Progress Tracking**: Visual progress indicators\n- **Contributions**: Track individual contributions with notes\n- **Priority Levels**: low, medium, high\n- **Status Management**: active, completed, abandoned\n- **API Endpoints**: [`/api/goals`](src/app/api/goals/route.ts:1) (GET, POST, PUT, DELETE)\n\n### 3.5 Portfolio Management\n- **Asset Types**: stock, crypto, fund, property\n- **Value Tracking**: Current value and purchase price\n- **Gain/Loss Calculation**: Automatic profit/loss computation\n- **API Endpoints**: [`/api/portfolio`](src/app/api/portfolio/route.ts:1) (GET, POST, PUT, DELETE)\n\n### 3.6 AI-Powered Financial Assistant (FinBot)\n- **Chat Interface**: Floating chat widget with conversation history\n- **Financial Context**: AI has access to user's real-time financial data\n- **Personalized Advice**: Context-aware financial recommendations\n- **Conversation Management**: Multiple conversations with titles\n- **Rate Limiting**: Protection against API abuse\n- **API Endpoints**: [`/api/chat`](src/app/api/chat/route.ts:1), [`/api/chat/conversations`](src/app/api/chat/conversations/route.ts:1)\n\n### 3.7 Dashboard & Reporting\n- **Overview Statistics**: Total balance, income, expenses, savings\n- **Visual Charts**: Bar charts for money flow visualization\n- **Recent Transactions**: Table view of latest transactions\n- **Budget Overview**: Visual budget progress indicators\n- **Goal Progress**: Saving goals with progress bars\n\n### 3.8 UI/UX Features\n- **Dark Mode**: Full dark mode support via next-themes\n- **Responsive Design**: Mobile-friendly navigation\n- **Toast Notifications**: User feedback system\n- **Loading States**: Loading indicators during data fetch\n\n---\n\n## 4. Data Models\n\n### 4.1 User Model\n```typescript\n{\n  name: String (required)\n  email: String (required, unique)\n  password: String (required, hashed)\n  bio: String\n  avatar: String\n  timestamps: true\n}\n```\n\n### 4.2 Finance Model\n```typescript\n{\n  userId: String (required)\n  type: 'income' | 'expense' (required)\n  amount: Number (required)\n  category: String (required)\n  description: String\n  date: Date (default: Date.now)\n}\n```\n\n### 4.3 Budget Model\n```typescript\n{\n  userId: String (required, indexed)\n  category: String (required)\n  monthlyLimit: Number (required)\n  period: {\n    month: Number (1-12, required)\n    year: Number (required)\n  }\n  alertThreshold: Number (default: 80)\n  isActive: Boolean (default: true)\n  timestamps: true\n}\n// Indexes: userId + period.year + period.month\n// Unique: userId + category + period.year + period.month\n```\n\n### 4.4 SavingGoal Model\n```typescript\n{\n  userId: String (required, indexed)\n  name: String (required)\n  targetAmount: Number (required)\n  currentAmount: Number (default: 0)\n  deadline: Date\n  priority: 'low' | 'medium' | 'high' (default: 'medium')\n  status: 'active' | 'completed' | 'abandoned' (default: 'active')\n  contributions: [{\n    amount: Number (required)\n    date: Date (default: Date.now)\n    note: String\n  }]\n  timestamps: true\n}\n```\n\n### 4.5 Portfolio Model\n```typescript\n{\n  userId: String (required)\n  asset: String (required)\n  type: 'stock' | 'crypto' | 'fund' | 'property' (required)\n  quantity: Number (required)\n  currentValue: Number (required)\n  purchasePrice: Number\n  timestamps: true\n}\n```\n\n### 4.6 ChatConversation Model\n```typescript\n{\n  userId: String (required, indexed)\n  title: String (default: 'New Conversation')\n  messages: [{\n    role: 'user' | 'assistant' | 'system' (required)\n    content: String (required)\n    timestamp: Date (default: Date.now)\n    metadata: {\n      tokensUsed: Number\n      model: String\n      financeContext: Boolean\n    }\n  }]\n  status: 'active' | 'archived' (default: 'active')\n  lastMessageAt: Date (default: Date.now)\n  timestamps: true\n}\n// Index: userId + lastMessageAt (descending)\n```\n\n### 4.7 UserPreferences Model\n```typescript\n{\n  userId: String (required, unique)\n  chatSettings: {\n    enableFinancialContext: Boolean (default: true)\n    preferredLanguage: String (default: 'id')\n    responseStyle: 'concise' | 'detailed' | 'educational' (default: 'detailed')\n  }\n  notificationSettings: {\n    anomalyAlerts: Boolean (default: true)\n    budgetReminders: Boolean (default: true)\n    weeklyInsights: Boolean (default: false)\n  }\n  privacySettings: {\n    shareDataWithAI: Boolean (default: true)\n    retainChatHistory: Boolean (default: true)\n  }\n}\n```\n\n---\n\n## 5. API Architecture\n\n### 5.1 Authentication Flow\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant Client\n    participant NextAuth\n    participant MongoDB\n    participant API\n\n    User->>Client: Enter credentials\n    Client->>NextAuth: POST /api/auth/[...nextauth]\n    NextAuth->>MongoDB: Find user by email\n    MongoDB-->>NextAuth: User document\n    NextAuth->>NextAuth: Compare password hash\n    NextAuth-->>Client: JWT token\n    Client->>API: Request with session\n    API->>NextAuth: Verify session\n    NextAuth-->>API: User info\n    API-->>Client: Response\n```\n\n### 5.2 Chatbot Flow\n\n```mermaid\nsequenceDiagram\n    participant User\n    participant ChatWidget\n    participant ChatAPI\n    participant ContextBuilder\n    participant OpenAI\n    participant MongoDB\n\n    User->>ChatWidget: Send message\n    ChatWidget->>ChatAPI: POST /api/chat\n    ChatAPI->>MongoDB: Get/create conversation\n    ChatAPI->>ContextBuilder: Build financial context\n    ContextBuilder->>MongoDB: Fetch finances, portfolio, budgets, goals\n    MongoDB-->>ContextBuilder: Financial data\n    ContextBuilder-->>ChatAPI: Formatted context\n    ChatAPI->>OpenAI: Chat completion request\n    OpenAI-->>ChatAPI: AI response\n    ChatAPI->>MongoDB: Save conversation\n    MongoDB-->>ChatAPI: Saved\n    ChatAPI-->>ChatWidget: Response\n    ChatWidget-->>User: Display message\n```\n\n### 5.3 API Endpoints Summary\n\n| Endpoint | Method | Description |\n|----------|--------|-------------|\n| `/api/auth/[...nextauth]` | GET/POST | NextAuth authentication |\n| `/api/register` | POST | User registration |\n| `/api/finances` | GET/POST/PUT/DELETE | Finance CRUD operations |\n| `/api/budgets` | GET/POST/PUT/DELETE | Budget management |\n| `/api/goals` | GET/POST/PUT/DELETE | Saving goals management |\n| `/api/goals/[id]/contribute` | POST | Add contribution to goal |\n| `/api/portfolio` | GET/POST/PUT/DELETE | Portfolio management |\n| `/api/chat` | POST | Send chat message |\n| `/api/chat/conversations` | GET | List conversations |\n| `/api/chat/conversations/[id]` | GET/DELETE | Conversation details |\n| `/api/insights/summary` | GET | Financial summary for AI |\n| `/api/profile` | GET/PUT | User profile |\n\n---\n\n## 6. AI Integration Details\n\n### 6.1 OpenAI Configuration\n- **Model**: GPT-4 Turbo Preview (configurable via `OPENAI_MODEL`)\n- **Max Tokens**: 1500 per response\n- **Temperature**: 0.7 (balanced creativity)\n- **Presence/Frequency Penalty**: 0.1 each\n\n### 6.2 System Prompt\nThe AI assistant (\"FinBot", "is configured with:\n- Indonesian language support\n- Financial advisor persona\n- Context-aware responses\n- Safety guardrails (no specific stock picks, no guarantees)\n- Indonesian financial context awareness\n\n### 6.3 Financial Context Builder\nThe [`context-builder.ts`](src/lib/context-builder.ts:1) service aggregates:\n- Income and expense summary (last 30 days)\n- Top spending categories\n- Portfolio allocation and performance\n- Active budgets with usage percentages\n- Saving goals with progress\n\n### 6.4 Rate Limiting\n- User-based rate limiting for chat API\n- Configurable limits via [`rate-limit.ts`](src/lib/rate-limit.ts:1)\n- HTTP 429 responses when limits exceeded\n\n---\n\n## 7. Security Considerations\n\n### 7.1 Implemented Security Measures\n| Measure | Implementation |\n|---------|----------------|\n| Password Hashing | bcrypt with salt rounds: 12 |\n| Session Management | JWT via NextAuth.js |\n| Route Protection | [`ProtectedRoute`](src/components/ProtectedRoute.tsx:1) component |\n| API Authentication | Session verification on all API routes |\n| User Isolation | All queries filtered by `userId` |\n| Input Validation | Basic validation on API endpoints |\n\n### 7.2 Potential Security Improvements\n1. **CSRF Protection**: Add CSRF tokens for state-changing operations\n2. **Input Sanitization**: Implement comprehensive input sanitization\n3. **Rate Limiting**: Expand rate limiting to all API endpoints\n4. **API Key Security**: Ensure OpenAI API key is properly secured\n5. **HTTPS Enforcement**: Force HTTPS in production\n6. **Content Security Policy**: Add CSP headers\n7. **SQL Injection Prevention**: Already using Mongoose (NoSQL), but validate all inputs\n8. **XSS Protection**: Implement proper output encoding\n\n---\n\n## 8. Performance Considerations\n\n### 8.1 Database Indexes\nThe following indexes are defined:\n- `ChatConversation`: `{ userId: 1, lastMessageAt: -1 }`\n- `Budget`: `{ userId: 1, 'period.year': 1, 'period.month': 1 }`\n- `Budget`: `{ userId: 1, category: 1, 'period.year': 1, 'period.month': 1 }` (unique)\n- `SavingGoal`: `{ userId: 1, status: 1 }`\n\n### 8.2 Optimization Opportunities\n1. **Caching**: Implement Redis for frequently accessed data\n2. **Pagination**: Add pagination to list endpoints\n3. **Lazy Loading**: Implement virtual scrolling for large lists\n4. **Image Optimization**: Use Next.js Image component\n5. **Bundle Analysis**: Optimize JavaScript bundle size\n6. **Database Connection Pooling**: Configure Mongoose connection pool\n\n---\n\n## 9. Current Implementation Status\n\n### 9.1 Completed Features\n- \u2705 User authentication (login/register)\n- \u2705 Finance tracking (income/expense CRUD)\n- \u2705 Budget management with tracking\n- \u2705 Saving goals with contributions\n- \u2705 Portfolio management\n- \u2705 Dashboard with visualizations\n- \u2705 AI chatbot with financial context\n- \u2705 Dark mode support\n- \u2705 Responsive design\n- \u2705 Toast notifications\n\n### 9.2 Partially Implemented Features\n- \u26a0\ufe0f Monthly reports (placeholder page exists)\n- \u26a0\ufe0f User preferences (model exists but not fully integrated)\n\n### 9.3 Planned Features (from existing plan)\n- \ud83d\udccb Expenditure prediction using TensorFlow.js\n- \ud83d\udccb Anomaly detection for transactions\n- \ud83d\udccb Investment optimization recommendations\n- \ud83d\udccb Enhanced notifications system\n\n---\n\n## 10. Code Quality Assessment\n\n### 10.1 Strengths\n1. **TypeScript Usage**: Strong typing throughout the codebase\n2. **Modular Architecture**: Clear separation of concerns\n3. **Component Reusability**: Well-structured React components\n4. **API Organization**: Consistent API route patterns\n5. **Error Handling**: Basic error handling in place\n\n### 10.2 Areas for Improvement\n1. **Error Messages**: Some error messages are in Indonesian, should be consistent\n2. **Validation**: Input validation could be more comprehensive\n3. **Testing**: No test files detected\n4. **Documentation**: Limited inline code documentation\n5. **Logging**: Minimal logging for debugging\n6. **Type Safety**: Some `any` types used in API routes\n\n---\n\n## 11. Deployment Considerations\n\n### 11.1 Environment Variables Required\n```env\nMONGODB_URI=          # MongoDB connection string\nOPENAI_API_KEY=       # OpenAI API key\nOPENAI_MODEL=         # OpenAI model (default: gpt-4-turbo-preview)\nNEXTAUTH_SECRET=      # NextAuth secret key\nNEXTAUTH_URL=         # Application URL\n```\n\n### 11.2 Deployment Platforms\n- **Vercel**: Recommended (native Next.js support)\n- **Netlify**: Alternative option\n- **Docker**: Containerized deployment possible\n- **Self-hosted**: Node.js server required\n\n### 11.3 Database\n- MongoDB Atlas (recommended for production)\n- Self-hosted MongoDB instance\n- Consider replica sets for high availability\n\n---\n\n## 12. Recommendations\n\n### 12.1 Immediate Improvements\n1. Add comprehensive input validation using Zod or similar\n2. Implement proper error handling with consistent error responses\n3. Add unit and integration tests\n4. Improve code documentation with JSDoc comments\n5. Add logging for debugging and monitoring\n\n### 12.2 Medium-term Enhancements\n1. Implement caching layer (Redis)\n2. Add email notifications for budget alerts\n3. Create comprehensive reporting features\n4. Add data export functionality (CSV, PDF)\n5. Implement multi-language support\n\n### 12.3 Long-term Features\n1. Machine learning for spending predictions\n2. Anomaly detection for unusual transactions\n3. Investment portfolio optimization\n4. Bank account integration (via Plaid or similar)\n5. Mobile app (React Native)\n\n---\n\n## 13. Conclusion\n\n**My Finance App** is a well-architected personal finance application with a solid foundation. The integration of AI-powered financial advice through OpenAI GPT-4 provides a unique value proposition. The codebase demonstrates good practices with TypeScript, modular architecture, and clear separation of concerns.\n\nThe application is production-ready for basic use cases but would benefit from additional testing, improved error handling, and enhanced security measures before scaling to a larger user base.\n\n---\n\n## Appendix: Key File References\n\n| File | Purpose |\n|------|---------|\n| [`src/lib/auth.ts`](src/lib/auth.ts:1) | NextAuth configuration |\n| [`src/lib/mongodb.ts`](src/lib/mongodb.ts:1) | Database connection |\n| [`src/lib/openai.ts`](src/lib/openai.ts:1) | OpenAI integration |\n| [`src/lib/context-builder.ts`](src/lib/context-builder.ts:1) | Financial context aggregation |\n| [`src/lib/prompts.ts`](src/lib/prompts.ts:1) | AI system prompts |\n| [`src/app/api/chat/route.ts`](src/app/api/chat/route.ts:1) | Chat API endpoint |\n| [`src/components/Header.tsx`](src/components/Header.tsx:1) | Navigation header |\n| [`src/app/dashboard/page.tsx`](src/app/dashboard/page.tsx:1) | Main dashboard |"]